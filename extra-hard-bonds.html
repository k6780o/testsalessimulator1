<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Extra Hard Bonds Simulator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #e5ddd5;
      margin: 0;
      padding: 1rem;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background-color: #fff;
      border-radius: 10px;
      padding: 1rem;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
      height: 90vh;
      display: flex;
      flex-direction: column;
    }
    .chat-box {
      flex-grow: 1;
      overflow-y: auto;
      padding: 1rem;
      background-color: #dcf8c6;
      border-radius: 10px;
      margin-bottom: 1rem;
    }
    .message {
      margin-bottom: 1rem;
      max-width: 75%;
      padding: 0.6rem 1rem;
      border-radius: 20px;
      clear: both;
      word-wrap: break-word;
    }
    .customer {
      background-color: #fff;
      float: left;
    }
    .sales {
      background-color: #34b7f1;
      color: #fff;
      float: right;
    }
    textarea, button {
      width: 100%;
      margin-top: 0.5rem;
      padding: 0.6rem;
      font-size: 1rem;
      border-radius: 10px;
      border: 1px solid #ccc;
      resize: none;
    }
    button {
      background-color: #25d366;
      color: white;
      border: none;
      margin-top: 0.5rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="chat-box" id="chatBox"></div>
    <textarea id="pitch" rows="3" placeholder="Type your pitch..."></textarea>
    <button onclick="submitPitch()">Send</button>
  </div>
  <script>
    const keywords = [
      "structured", "hedged", "inflation-protected", "creditworthy", "secure yield", "robust", "counter-cyclical",
      "capital preservation", "low volatility", "tax-advantaged", "stable income", "risk-adjusted", "bond laddering",
      "investment-grade", "macro-resistant", "non-correlated", "safe-haven", "resilient", "underlying assets",
      "duration management", "credit spread", "yield curve", "derivatives", "fixed income", "callable bonds",
      "convertible bonds", "liquidity risk", "credit enhancement", "default risk"
    ];

    const customer = {
      name: "Cameron",
      mood: "very demanding and skeptical",
      investment: Math.floor(Math.random() * 9500000 + 500000).toLocaleString(),
      questions: [
        "How does this bond’s risk profile compare to municipal bonds in volatile markets?",
        "What guarantees exist for principal protection in an economic downturn?",
        "Explain how duration and credit spreads affect this bond's performance.",
        "Can you provide details about credit enhancements or collateral involved?",
        "What’s the impact of potential callable or convertible features on yield?",
        "How does this fit into a diversified fixed income portfolio in today's interest rate environment?"
      ]
    };

    let chatBox = document.getElementById("chatBox");
    let questionIndex = 0;
    let pitchScore = 0;

    function addMessage(text, sender) {
      const msg = document.createElement("div");
      msg.className = `message ${sender}`;
      msg.innerText = text;
      chatBox.appendChild(msg);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    function nextQuestion() {
      if (questionIndex < customer.questions.length) {
        addMessage(`${customer.name} (${customer.mood}): ${customer.questions[questionIndex]}`, "customer");
      } else {
        addMessage(`${customer.name}: Your explanations are thorough. I’m ready to invest $${customer.investment}.`, "customer");
      }
    }

    function submitPitch() {
      const pitchInput = document.getElementById("pitch");
      const pitch = pitchInput.value.toLowerCase();
      if (!pitch.trim()) return;

      addMessage(pitchInput.value, "sales");
      pitchInput.value = "";

      let matchCount = keywords.filter(word => pitch.includes(word)).length;
      if (matchCount > 0) pitchScore += matchCount;

      if (pitchScore >= 10) {
        questionIndex++;
        nextQuestion();
      } else {
        const responses = [
          `${customer.name}: Your points lack sufficient detail. Please address the technical risks more specifically.`,
          `${customer.name}: I need clearer evidence of risk mitigation strategies before proceeding.`,
          `${customer.name}: That explanation doesn't convince me of the bond’s resilience. Elaborate more.`,
          `${customer.name}: You're missing critical details about credit risk and yield curves. Can you expand?`,
          `${customer.name}: I expect a deeper analysis on callable or convertible features. Please clarify.`,
        ];
        addMessage(responses[Math.floor(Math.random() * responses.length)], "customer");
      }
    }

    // Start conversation
    nextQuestion();
  </script>
</body>
</html>
